{% extends "admin/base.html" %}

{% block content %}

<div class="container mt-5">
    <h1 class="mb-4">Editar Produto</h1>
    <form id="edit-produto-form">
        <div class="mb-3">
            <label for="nome" class="form-label">Nome</label>
            <input type="text" class="form-control" id="nome" name="nome" value="{{ produto.nome }}">
        </div>
        <div class="mb-3">
            <label for="categoria" class="form-label">Categoria</label>
            <input type="text" class="form-control" id="categoria" name="categoria" value="{{ produto.categoria }}">
        </div>
        <div class="mb-3">
            <label for="preco" class="form-label">Preço</label>
            <input type="number" step="0.01" class="form-control" id="preco" name="preco" value="{{ produto.preco }}">
        </div>
        <div class="mb-3">
            <label for="quantidade_estoque" class="form-label">Quantidade em Estoque</label>
            <input type="number" class="form-control" id="quantidade_estoque" name="quantidade_estoque" value="{{ produto.quantidade_estoque }}">
        </div>
        <div class="mb-3">
            <label for="imagem" class="form-label">Imagem</label>
            <input type="text" class="form-control" id="imagem" name="imagem" value="{{ produto.imagem }}">
        </div>
        <div class="mb-3">
            <label for="cor" class="form-label">Cor</label>
            <input type="text" class="form-control" id="cor" name="cor" value="{{ produto.cor }}">
        </div>
        <div class="mb-3">
            <label for="estilo" class="form-label">Estilo</label>
            <input type="text" class="form-control" id="estilo" name="estilo" value="{{ produto.estilo }}">
        </div>
        <div class="mb-3">
            <label for="publicado" class="form-label">Publicado</label>
            <input type="checkbox" class="form-check-input" id="publicado" name="publicado" {{ 'checked' if produto.publicado else '' }}>
        </div>
        <button type="submit" class="btn btn-primary">Salvar Alterações</button>
    </form>
</div>

<script>
    document.getElementById('edit-produto-form').onsubmit = async function(event) {
        event.preventDefault();
        const formData = new FormData(event.target);
        const data = Object.fromEntries(formData.entries());
        data.publicado = formData.has('publicado');

        const response = await fetch('/produtos/' + {{ produto.id }}, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        });

        if (response.ok) {
            window.location.href = '/visualizar_produtos/';
        } else {
            alert('Erro ao salvar as alterações');
        }
    };
</script>

{% endblock %}